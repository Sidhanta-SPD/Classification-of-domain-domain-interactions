#this code finds the fold distribution. replace the comments where necessary
import pandas as pd
import numpy as np
#import matplotlib.pyplot as plt
import collections



obl_cla_file=pd.read_csv('obl_cla_file',sep='\t',header=None)
non_obl_cla_file=pd.read_csv('non_obl_cla_file',sep='\t',header=None)
obl_file=pd.read_csv('obl_pdbs_lower',header=None)
non_obl_file=pd.read_csv('non_obl_pdbs_lower',header=None)
des_file=pd.read_csv('dir.des.scope.2.07-stable.txt', sep='\t', header=None)
obl_homodomains=pd.read_csv('../../homodomains/obl_homodomain_pdbs',header=None)#pdbs of homodomains
non_obl_homodomains=pd.read_csv('../../homodomains/non_obl_homodomain_pdbs',header=None)


#\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
#fold distribution of all proteins
#storing sccs ids
obl_sccs=[]#sccs ids of obl
for i in range(len(obl_file)):
    for j in range(len(obl_cla_file)):
        if obl_file.iloc[i,0] == obl_cla_file.iloc[j,1]:
            obl_sccs.append(obl_cla_file.iloc[j,3])

non_obl_sccs=[]#sccs ids of non_obl
for i in range(len(non_obl_file)):
    for j in range(len(non_obl_cla_file)):
        if non_obl_file.iloc[i,0] == non_obl_cla_file.iloc[j,1]:
            non_obl_sccs.append(non_obl_cla_file.iloc[j,3])


#takes time to run. Hence output is written directly from the first run
#finding fold details from des file
obl_folds=[]
non_obl_folds=[]

for ids in obl_sccs:
    fold='.'.join(ids.split('.')[0:2])
    #print(fold)
    for k in range(len(des_file)):
        if des_file.iloc[k,2] == fold:
            #print(des_file.iloc[k,4])
            obl_folds.append(des_file.iloc[k,4])
print('~~~~~~~')
for ids in non_obl_sccs:
    fold='.'.join(ids.split('.')[0:2])
    #print(fold)
    for k in range(len(des_file)):
        if des_file.iloc[k,2] == fold:
            #print(des_file.iloc[k,4])
            non_obl_folds.append(des_file.iloc[k,4])

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#OUTPUTS folds of all proteins
#obl_fold_output=['LEM/SAP HeH motif', 'OB-fold', 'Concanavalin A-like lectins/glucanases', 'beta-Trefoil', 'CH domain-like', 'CH domain-like', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Glyoxalase/Bleomycin resistance protein/Dihydroxybiphenyl dioxygenase', 'Glyoxalase/Bleomycin resistance protein/Dihydroxybiphenyl dioxygenase', 'SH3-like barrel', 'OB-fold', 'Aha1/BPI domain-like', 'Aha1/BPI domain-like', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Interferon-induced guanylate-binding protein 1 (GBP1), C-terminal domain', 'P-loop containing nucleoside triphosphate hydrolases', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'OB-fold', 'ATP-grasp', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'DNA/RNA-binding 3-helical bundle', 'DNA/RNA-binding 3-helical bundle', '7-bladed beta-propeller', 'alpha/beta-Hydrolases', 'Ribonuclease H-like motif', 'Ribonuclease H-like motif', 'Ribonuclease H-like motif', 'DNA/RNA polymerases', 'alpha-alpha superhelix', 'Cyclophilin-like', 'DNA/RNA-binding 3-helical bundle', 'HPr-like', 'Lesion bypass DNA polymerase (Y-family), little finger domain', 'DNA/RNA polymerases', 'PEP carboxykinase-like', 'PEP carboxykinase N-terminal domain', 'SH3-like barrel', 'P-loop containing nucleoside triphosphate hydrolases', 'DNA/RNA-binding 3-helical bundle', 'P-loop containing nucleoside triphosphate hydrolases', 'NAD(P)-binding Rossmann-fold domains', 'LDH C-terminal domain-like', 'Trypsin-like serine proteases', 'Complement control module/SCR domain', 'alpha-alpha superhelix', 'beta-Trefoil', 'Acyl-CoA N-acyltransferases (Nat)', 'Acyl-CoA N-acyltransferases (Nat)', '7-bladed beta-propeller', '7-bladed beta-propeller', 'DBL homology domain (DH-domain)', 'PH domain-like barrel', '(Phosphotyrosine protein) phosphatases II', '(Phosphotyrosine protein) phosphatases II', 'DNA/RNA-binding 3-helical bundle', 'DNA/RNA-binding 3-helical bundle', '7-bladed beta-propeller', '7-bladed beta-propeller', 'PUA domain-like', 'Cystatin-like', 'Ribonuclease H-like motif', 'DNA/RNA polymerases', 'ADP-ribosylation', 'ADP-ribosylation', 'Immunoglobulin-like beta-sandwich', 'Subdomain of clathrin and coatomer appendage domain', 'DNA/RNA-binding 3-helical bundle', 'S-adenosyl-L-methionine-dependent methyltransferases', 'Bromodomain-like', 'Acyl-CoA dehydrogenase NM domain-like', 'Rhodanese/Cell cycle control phosphatase', 'Rhodanese/Cell cycle control phosphatase', 'R1 subunit of ribonucleotide reductase, N-terminal domain', 'PFL-like glycyl radical enzymes', 'Ribonuclease H-like motif', 'DNA/RNA polymerases', 'NAD(P)-binding Rossmann-fold domains', 'LDH C-terminal domain-like', 'Single-stranded right-handed beta-helix', 'Zincin-like', 'PUA domain-like', 'Cystatin-like', 'Subtilisin-like', 'Ferredoxin-like', 'DBL homology domain (DH-domain)', 'PH domain-like barrel', 'Cryptochrome/photolyase FAD-binding domain', 'Cryptochrome/photolyase, N-terminal domain', 'Spectrin repeat-like', 'Spectrin repeat-like', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Ribosomal protein S5 domain 2-like', 'Ferredoxin-like', 'Phospholipase D/nuclease', 'Phospholipase D/nuclease', 'Spectrin repeat-like', 'TrkA C-terminal domain-like', 'Phosphotyrosine protein phosphatases I-like', 'Ribonuclease H-like motif', 'SH3-like barrel', 'OB-fold', 'LEM/SAP HeH motif', 'FYVE/PHD zinc finger', 'DNA methylase specificity domain', 'DNA methylase specificity domain', 'Tubulin nucleotide-binding domain-like', 'Bacillus chorismate mutase-like', 'DNA/RNA-binding 3-helical bundle', 'Protein kinase-like (PK-like)', 'Duffy binding domain-like', 'Duffy binding domain-like', 'The "swivelling" beta/beta/alpha domain', 'Aconitase iron-sulfur domain', 'Anticodon-binding domain of a subclass of class I aminoacyl-tRNA synthetases', 'Adenine nucleotide alpha hydrolase-like', 'ATC-like', 'ATC-like', 'CoA-dependent acyltransferases', 'CoA-dependent acyltransferases', 'post-AAA+ oligomerization domain-like', 'P-loop containing nucleoside triphosphate hydrolases', 'Hyaluronidase domain-like', 'Gelsolin-like', 'Ferredoxin-like', 'FAD-binding/transporter-associated domain-like', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'ADP-ribosylation', 'ADP-ribosylation', 'beta-hairpin stack', 'TIM beta/alpha-barrel', '(Phosphotyrosine protein) phosphatases II', '(Phosphotyrosine protein) phosphatases II', 'Tubulin nucleotide-binding domain-like', 'Bacillus chorismate mutase-like', 'Concanavalin A-like lectins/glucanases', 'beta-Trefoil', 'Hyaluronate lyase-like, C-terminal domain', 'P-loop containing nucleoside triphosphate hydrolases', 'ADP-ribosylation', 'ADP-ribosylation', 'Four-helical up-and-down bundle', 'P-loop containing nucleoside triphosphate hydrolases', 'NAD(P)-binding Rossmann-fold domains', 'Flavodoxin-like', 'CBS-domain pair', 'CBS-domain pair', '7-bladed beta-propeller', '7-bladed beta-propeller', 'DNA/RNA-binding 3-helical bundle', 'DNA/RNA-binding 3-helical bundle', 'Domain of poly(ADP-ribose) polymerase', 'ADP-ribosylation', 'N-terminal domain of bifunctional PutA protein', 'TIM beta/alpha-barrel', 'DNA clamp', 'DNA clamp', 'Concanavalin A-like lectins/glucanases', 'beta-Trefoil', 'Ribosomal protein S5 domain 2-like', 'Ferredoxin-like', 'SAM domain-like', 'PIN domain-like', 'Ribosomal protein S5 domain 2-like', 'ATPase domain of HSP90 chaperone/DNA topoisomerase II/histidine kinase', 'Penicillin-binding protein associated domain', 'beta-lactamase/transpeptidase-like', 'Concanavalin A-like lectins/glucanases', 'beta-Trefoil', 'Double-stranded beta-helix', 'Double-stranded beta-helix', 'alpha-alpha superhelix', 'U5 small nuclear riboprotein particle assembly factor Aar2 N-terminal domain-like', 'Thiolase-like', 'Thiolase-like', 'Anthrax protective antigen N-terminal-like', 'Anthrax protective antigen C-terminal-like', 'SH3-like barrel', 'OB-fold', 'DNA/RNA-binding 3-helical bundle', 'alpha-alpha superhelix', 'Ribonuclease H-like motif', 'Ribonuclease H-like motif', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'alpha/alpha toroid', 'Terpenoid synthases', 'Concanavalin A-like lectins/glucanases', 'Concanavalin A-like lectins/glucanases', 'alpha-alpha superhelix', 'Menin N-terminal domain-like', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', '7-bladed beta-propeller', '7-bladed beta-propeller', 'Ferredoxin-like', 'FAD-binding/transporter-associated domain-like', '6-phosphogluconate dehydrogenase C-terminal domain-like', 'NAD(P)-binding Rossmann-fold domains', 'alpha/alpha toroid', 'Terpenoid synthases', 'Spectrin repeat-like', 'Spectrin repeat-like', '7-bladed beta-propeller', 'alpha/beta-Hydrolases', 'Cryptochrome/photolyase FAD-binding domain', 'Cryptochrome/photolyase, N-terminal domain', 'alpha/alpha toroid', 'Terpenoid synthases', 'Double-stranded beta-helix', 'Double-stranded beta-helix', 'NAD(P)-binding Rossmann-fold domains', 'Aminoacid dehydrogenase-like, N-terminal domain']
#non_obl_fold_output=['OB-fold', 'ATP-grasp', 'SAM domain-like', 'DNA breaking-rejoining enzymes', 'DNA/RNA-binding 3-helical bundle', 'Iron-dependent repressor protein, dimerization domain', 'GST C-terminal domain-like', 'Thioredoxin fold', 'BPTI-like', 'BPTI-like', 'P-loop containing nucleoside triphosphate hydrolases', 'P-loop containing nucleoside triphosphate hydrolases', 'Phospholipase C/P1 nuclease', 'Lipase/lipooxygenase domain (PLAT/LH2 domain)', 'alpha/alpha toroid', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Caspase-like', 'Double-stranded beta-helix', 'Double-stranded beta-helix', 'beta-hairpin-alpha-hairpin repeat', 'ArfGap/RecO-like zinc finger', 'Reductase/isomerase/elongation factor common domain', 'Ferredoxin reductase-like, C-terminal NADP-linked domain', 'OB-fold', 'beta-Grasp (ubiquitin-like)', 'Rhodanese/Cell cycle control phosphatase', 'Rhodanese/Cell cycle control phosphatase', 'Trypsin-like serine proteases', 'Complement control module/SCR domain', 'Knottins (small inhibitors, toxins, lectins)', 'Knottins (small inhibitors, toxins, lectins)', 'OB-fold', 'beta-Grasp (ubiquitin-like)', 'OB-fold', 'beta-Grasp (ubiquitin-like)', 'Reductase/isomerase/elongation factor common domain', 'Ferredoxin reductase-like, C-terminal NADP-linked domain', 'TIM beta/alpha-barrel', 'Enolase N-terminal domain-like', 'Guanido kinase N-terminal domain', 'Glutamine synthetase/guanido kinase', 'C-type lectin-like', 'Knottins (small inhibitors, toxins, lectins)', 'N-terminal domains of the minor coat protein g3p', 'N-terminal domains of the minor coat protein g3p', 'Four-helical up-and-down bundle', '(Phosphotyrosine protein) phosphatases II', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'GFP-like', 'Knottins (small inhibitors, toxins, lectins)', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'FAD-binding/transporter-associated domain-like', 'Uridine diphospho-N-Acetylenolpyruvylglucosamine reductase, MurB, C-terminal domain', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'OB-fold', 'beta-Grasp (ubiquitin-like)', 'PreATP-grasp domain', 'ATP-grasp', 'alpha/beta knot', 'Bacillus chorismate mutase-like', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'Cytochrome c', '8-bladed beta-propeller', '6-phosphogluconate dehydrogenase C-terminal domain-like', 'NAD(P)-binding Rossmann-fold domains', 'PGBD-like', 'Hedgehog/DD-peptidase', 'PDZ domain-like', 'Trypsin-like serine proteases', 'Lipoxigenase', 'Lipase/lipooxygenase domain (PLAT/LH2 domain)', 'Four-helical up-and-down bundle', 'P-loop containing nucleoside triphosphate hydrolases', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'Cupredoxin-like', 'Cupredoxin-like', 'P-loop containing nucleoside triphosphate hydrolases', 'Hypothetical protein YjiA, C-terminal domain', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'FAS1 domain', 'FAS1 domain', 'SAM domain-like', 'alpha-alpha superhelix', 'Nucleoplasmin-like/VP (viral coat and capsid proteins)', 'Nucleoplasmin-like/VP (viral coat and capsid proteins)', 'RuvA C-terminal domain-like', 'SpoIIaa-like', 'PUA domain-like', 'Adenine nucleotide alpha hydrolase-like', 'DNA/RNA-binding 3-helical bundle', 'Flavodoxin-like', 'alpha/alpha toroid', 'Immunoglobulin-like beta-sandwich', 'TIM beta/alpha-barrel', 'Enolase N-terminal domain-like', 'P-loop containing nucleoside triphosphate hydrolases', 'P-loop containing nucleoside triphosphate hydrolases', 'Ferritin-like', 'Rubredoxin-like', 'CH domain-like', 'CH domain-like', 'SH3-like barrel', 'P-loop containing nucleoside triphosphate hydrolases', 'beta-Grasp (ubiquitin-like)', 'RRF/tRNA synthetase additional domain-like', 'Ribbon-helix-helix', 'Ribbon-helix-helix', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'Rhodanese/Cell cycle control phosphatase', 'Rhodanese/Cell cycle control phosphatase', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'immunoglobulin/albumin-binding domain-like', '7-stranded beta/alpha barrel', 'Long alpha-hairpin', 'Fe,Mn superoxide dismutase (SOD), C-terminal domain', 'OB-fold', 'S-adenosyl-L-methionine-dependent methyltransferases', 'Prealbumin-like', 'TIM beta/alpha-barrel', 'beta-clip', 'TIM beta/alpha-barrel', 'Elongation factor/aminomethyltransferase common domain', 'Folate-binding domain', 'P-loop containing nucleoside triphosphate hydrolases', 'Alpha-lytic protease prodomain-like', 'Galactose-binding domain-like', 'TIM beta/alpha-barrel', 'Double psi beta-barrel', 'Cdc48 domain 2-like', 'Galactose-binding domain-like', 'Subtilisin-like', 'Elongation factor/aminomethyltransferase common domain', 'Folate-binding domain', 'PR-1-like', 'Crisp domain-like', 'Concanavalin A-like lectins/glucanases', '5-bladed beta-propeller', 'WWE domain', 'WWE domain', 'PUA domain-like', 'S-adenosyl-L-methionine-dependent methyltransferases', 'Reductase/isomerase/elongation factor common domain', 'Ferredoxin reductase-like, C-terminal NADP-linked domain', 'MFPT repeat-like', 'MFPT repeat-like', 'Reductase/isomerase/elongation factor common domain', 'Ferredoxin reductase-like, C-terminal NADP-linked domain', 'beta-clip', 'beta-clip', 'Immunoglobulin-like beta-sandwich', 'Concanavalin A-like lectins/glucanases', 'FnI-like domain', 'FnI-like domain', 'EF Hand-like', 'EF Hand-like', 'Reductase/isomerase/elongation factor common domain', 'Ferredoxin reductase-like, C-terminal NADP-linked domain', 'DNA/RNA-binding 3-helical bundle', 'Ferredoxin-like', 'Reductase/isomerase/elongation factor common domain', 'RRF/tRNA synthetase additional domain-like', 'Eukaryotic type KH-domain (KH-domain type I)', 'Eukaryotic type KH-domain (KH-domain type I)', 'Ribonuclease H-like motif', 'Ribonuclease H-like motif', 'SH3-like barrel', 'SH3-like barrel', 'Diaminopimelate epimerase-like', 'Diaminopimelate epimerase-like', 'SH3-like barrel', 'Cysteine proteinases', 'C2 domain-like', 'Double psi beta-barrel', 'DNA/RNA-binding 3-helical bundle', 'GntR ligand-binding domain-like', 'Cyclin-like', 'Cyclin-like', 'Double psi beta-barrel', 'Formate dehydrogenase/DMSO reductase, domains 1-3', 'Galactose-binding domain-like', 'Flavodoxin-like', 'Polo-box domain', 'Polo-box domain', 'P-loop containing nucleoside triphosphate hydrolases', 'beta-Grasp (ubiquitin-like)', 'DNA/RNA-binding 3-helical bundle', 'DCoH-like', 'T-fold', 'T-fold', 'Sec63 N-terminal domain-like', 'Immunoglobulin-like beta-sandwich', 'PRC-barrel domain', 'Reductase/isomerase/elongation factor common domain', 'GST C-terminal domain-like', 'Thioredoxin fold', 'OB-fold', 'OB-fold', 'Concanavalin A-like lectins/glucanases', '6-bladed beta-propeller', 'P-loop containing nucleoside triphosphate hydrolases', 'P-loop containing nucleoside triphosphate hydrolases', 'DNA/RNA-binding 3-helical bundle', 'DNA/RNA-binding 3-helical bundle', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', "5'-nucleotidase (syn. UDP-sugar hydrolase), C-terminal domain", 'Metallo-dependent phosphatases', 'P-loop containing nucleoside triphosphate hydrolases', 'P-loop containing nucleoside triphosphate hydrolases', 'Class II aaRS and biotin synthetases', 'SufE/NifU', 'beta-Trefoil', 'beta-Trefoil', 'SH3-like barrel', 'beta-hairpin-alpha-hairpin repeat', 'OB-fold', 'beta-Grasp (ubiquitin-like)', 'FAD-binding/transporter-associated domain-like', 'Uridine diphospho-N-Acetylenolpyruvylglucosamine reductase, MurB, C-terminal domain', 'Ribosomal protein S5 domain 2-like', 'Ribosomal protein S5 domain 2-like', 'RuvA C-terminal domain-like', 'SpoIIaa-like', 'DNA/RNA-binding 3-helical bundle', 'Flavodoxin-like', 'Double psi beta-barrel', 'Cdc48 domain 2-like', 'ClpP/crotonase', 'ClpP/crotonase', 'OB-fold', 'beta-Grasp (ubiquitin-like)', 'Ferredoxin-like', 'CCCH zinc finger', '6-phosphogluconate dehydrogenase C-terminal domain-like', 'NAD(P)-binding Rossmann-fold domains', 'TIM beta/alpha-barrel', 'Flavodoxin-like', 'TNF receptor-like', 'TNF receptor-like', 'TIM beta/alpha-barrel', 'Zincin-like', 'TIM beta/alpha-barrel', 'Enolase N-terminal domain-like', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'Periplasmic binding protein-like II', 'dsRBD-like', 'Profilin-like', 'Profilin-like', '6-phosphogluconate dehydrogenase C-terminal domain-like', 'NAD(P)-binding Rossmann-fold domains', 'Penicillin binding protein dimerisation domain', 'beta-lactamase/transpeptidase-like', 'Another 3-helical bundle', 'PP2C-like', 'Cysteine proteinases', 'beta-Grasp (ubiquitin-like)', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'PDZ domain-like', 'PDZ domain-like', 'alpha-alpha superhelix', 'GUN4-like', 'Galactose-binding domain-like', 'Subtilisin-like', 'CH domain-like', 'CH domain-like', 'GST C-terminal domain-like', 'Thioredoxin fold', 'Concanavalin A-like lectins/glucanases', 'Concanavalin A-like lectins/glucanases', 'Glycosyl hydrolase domain', 'TIM beta/alpha-barrel', 'gamma-Crystallin-like', 'gamma-Crystallin-like', 'Profilin-like', 'Profilin-like', 'Reductase/isomerase/elongation factor common domain', 'Ferredoxin reductase-like, C-terminal NADP-linked domain', 'Reductase/isomerase/elongation factor common domain', 'P-loop containing nucleoside triphosphate hydrolases', 'DNA/RNA-binding 3-helical bundle', 'P-loop containing nucleoside triphosphate hydrolases', '7-bladed beta-propeller', 'alpha/beta-Hydrolases', 'Periplasmic binding protein-like II', 'Periplasmic binding protein-like II', 'TIM beta/alpha-barrel', 'TIM beta/alpha-barrel', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'PEP carboxykinase-like', 'PEP carboxykinase N-terminal domain', 'Bromodomain-like', 'Bromodomain-like', 'WW domain-like', 'FKBP-like']


#\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
#fold distribution of homodomains
h_obl_sccs=[]#sccs ids of obl homodomains
for i in range(len(obl_homodomains)):
    for j in range(len(obl_cla_file)):
        if obl_homodomains.iloc[i,0].lower() == obl_cla_file.iloc[j,1]:
            h_obl_sccs.append(obl_cla_file.iloc[j,3])

h_non_obl_sccs=[]#sccs ids of non_obl homodomains
for i in range(len(non_obl_homodomains)):
    for j in range(len(non_obl_cla_file)):
        if non_obl_homodomains.iloc[i,0].lower() == non_obl_cla_file.iloc[j,1]:
            h_non_obl_sccs.append(non_obl_cla_file.iloc[j,3])


#finding folds
h_obl_folds=[]#folds of obligate homodomains
h_non_obl_folds=[]#folds of non-obligate homodomains

for ids in h_obl_sccs:
    fold='.'.join(ids.split('.')[0:2])
    #print(fold)
    for k in range(len(des_file)):
        if des_file.iloc[k,2] == fold:
            #print(des_file.iloc[k,4])
            h_obl_folds.append(des_file.iloc[k,4])
print('~~~~~~~')
for ids in h_non_obl_sccs:
    fold='.'.join(ids.split('.')[0:2])
    #print(fold)
    for k in range(len(des_file)):
        if des_file.iloc[k,2] == fold:
            #print(des_file.iloc[k,4])
            h_non_obl_folds.append(des_file.iloc[k,4])


#h_obl_fold_output=['CH domain-like', 'CH domain-like', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Glyoxalase/Bleomycin resistance protein/Dihydroxybiphenyl dioxygenase', 'Glyoxalase/Bleomycin resistance protein/Dihydroxybiphenyl dioxygenase', 'Aha1/BPI domain-like', 'Aha1/BPI domain-like', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'DNA/RNA-binding 3-helical bundle', 'DNA/RNA-binding 3-helical bundle', 'Ribonuclease H-like motif', 'Ribonuclease H-like motif', 'Acyl-CoA N-acyltransferases (Nat)', 'Acyl-CoA N-acyltransferases (Nat)', '7-bladed beta-propeller', '7-bladed beta-propeller', '(Phosphotyrosine protein) phosphatases II', '(Phosphotyrosine protein) phosphatases II', 'DNA/RNA-binding 3-helical bundle', 'DNA/RNA-binding 3-helical bundle', '7-bladed beta-propeller', '7-bladed beta-propeller', 'ADP-ribosylation', 'ADP-ribosylation', 'Rhodanese/Cell cycle control phosphatase', 'Rhodanese/Cell cycle control phosphatase', 'Spectrin repeat-like', 'Spectrin repeat-like', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Phospholipase D/nuclease', 'Phospholipase D/nuclease', 'DNA methylase specificity domain', 'DNA methylase specificity domain', 'Duffy binding domain-like', 'Duffy binding domain-like', 'ATC-like', 'ATC-like', 'CoA-dependent acyltransferases', 'CoA-dependent acyltransferases', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'ADP-ribosylation', 'ADP-ribosylation', '(Phosphotyrosine protein) phosphatases II', '(Phosphotyrosine protein) phosphatases II', 'ADP-ribosylation', 'ADP-ribosylation', 'CBS-domain pair', 'CBS-domain pair', '7-bladed beta-propeller', '7-bladed beta-propeller', 'DNA/RNA-binding 3-helical bundle', 'DNA/RNA-binding 3-helical bundle', 'DNA clamp', 'DNA clamp', 'Double-stranded beta-helix', 'Double-stranded beta-helix', 'Thiolase-like', 'Thiolase-like', 'Ribonuclease H-like motif', 'Ribonuclease H-like motif', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Concanavalin A-like lectins/glucanases', 'Concanavalin A-like lectins/glucanases', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', '7-bladed beta-propeller', '7-bladed beta-propeller', 'Spectrin repeat-like', 'Spectrin repeat-like', 'Double-stranded beta-helix', 'Double-stranded beta-helix']
#h_non_obl_fold_output=['BPTI-like', 'BPTI-like', 'P-loop containing nucleoside triphosphate hydrolases', 'P-loop containing nucleoside triphosphate hydrolases', 'Double-stranded beta-helix', 'Double-stranded beta-helix', 'Rhodanese/Cell cycle control phosphatase', 'Rhodanese/Cell cycle control phosphatase', 'Knottins (small inhibitors, toxins, lectins)', 'Knottins (small inhibitors, toxins, lectins)', 'N-terminal domains of the minor coat protein g3p', 'N-terminal domains of the minor coat protein g3p', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Cupredoxin-like', 'Cupredoxin-like', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'FAS1 domain', 'FAS1 domain', 'Nucleoplasmin-like/VP (viral coat and capsid proteins)', 'Nucleoplasmin-like/VP (viral coat and capsid proteins)', 'P-loop containing nucleoside triphosphate hydrolases', 'P-loop containing nucleoside triphosphate hydrolases', 'CH domain-like', 'CH domain-like', 'Ribbon-helix-helix', 'Ribbon-helix-helix', 'Rhodanese/Cell cycle control phosphatase', 'Rhodanese/Cell cycle control phosphatase', 'WWE domain', 'WWE domain', 'MFPT repeat-like', 'MFPT repeat-like', 'beta-clip', 'beta-clip', 'FnI-like domain', 'FnI-like domain', 'EF Hand-like', 'EF Hand-like', 'Eukaryotic type KH-domain (KH-domain type I)', 'Eukaryotic type KH-domain (KH-domain type I)', 'Ribonuclease H-like motif', 'Ribonuclease H-like motif', 'SH3-like barrel', 'SH3-like barrel', 'Diaminopimelate epimerase-like', 'Diaminopimelate epimerase-like', 'Cyclin-like', 'Cyclin-like', 'Polo-box domain', 'Polo-box domain', 'T-fold', 'T-fold', 'OB-fold', 'OB-fold', 'P-loop containing nucleoside triphosphate hydrolases', 'P-loop containing nucleoside triphosphate hydrolases', 'DNA/RNA-binding 3-helical bundle', 'DNA/RNA-binding 3-helical bundle', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'P-loop containing nucleoside triphosphate hydrolases', 'P-loop containing nucleoside triphosphate hydrolases', 'beta-Trefoil', 'beta-Trefoil', 'Ribosomal protein S5 domain 2-like', 'Ribosomal protein S5 domain 2-like', 'ClpP/crotonase', 'ClpP/crotonase', 'TNF receptor-like', 'TNF receptor-like', 'PDZ domain-like', 'PDZ domain-like', 'CH domain-like', 'CH domain-like', 'Concanavalin A-like lectins/glucanases', 'Concanavalin A-like lectins/glucanases', 'gamma-Crystallin-like', 'gamma-Crystallin-like', 'Periplasmic binding protein-like II', 'Periplasmic binding protein-like II', 'TIM beta/alpha-barrel', 'TIM beta/alpha-barrel', 'Immunoglobulin-like beta-sandwich', 'Immunoglobulin-like beta-sandwich', 'Bromodomain-like', 'Bromodomain-like']



#the code takes time as it has to loop a lot. The output is directly written manually.
#replace h_obl_folds with h_obl_fold_output
#replace h_non_obl_folds with h_non_obl_fold_output

#finding frequency and sorting
Hobl_freq=dict(collections.Counter(h_obl_fold_output))#counter of frequency
Hobl_freq_sorted={key: value for key, value in sorted(Hobl_freq.items(),key=lambda item: item[1], reverse=True)}#sorted counter of frequency
Hnon_obl_freq=dict(collections.Counter(h_non_obl_fold_output))
Hnon_obl_freq_sorted={key: value for key, value in sorted(Hnon_obl_freq.items(),key=lambda item: item[1], reverse=True)}

#`````````````````````````````````````````````````````````
obl_freq_sorted={'Immunoglobulin-like beta-sandwich': 19, 'DNA/RNA-binding 3-helical bundle': 11, '7-bladed beta-propeller': 10, 'Ribonuclease H-like motif': 8, 'ADP-ribosylation': 7, 'Concanavalin A-like lectins/glucanases': 6, 'P-loop containing nucleoside triphosphate hydrolases': 6, 'OB-fold': 5, 'beta-Trefoil': 5, 'alpha-alpha superhelix': 5, 'Ferredoxin-like': 5, 'Spectrin repeat-like': 5, 'SH3-like barrel': 4, 'DNA/RNA polymerases': 4, '(Phosphotyrosine protein) phosphatases II': 4, 'NAD(P)-binding Rossmann-fold domains': 4, 'Double-stranded beta-helix': 4, 'Ribosomal protein S5 domain 2-like': 3, 'alpha/alpha toroid': 3, 'Terpenoid synthases': 3, 'LEM/SAP HeH motif': 2, 'CH domain-like': 2, 'Glyoxalase/Bleomycin resistance protein/Dihydroxybiphenyl dioxygenase': 2, 'Aha1/BPI domain-like': 2, 'alpha/beta-Hydrolases': 2, 'Acyl-CoA N-acyltransferases (Nat)': 2, 'DBL homology domain (DH-domain)': 2, 'PH domain-like barrel': 2, 'PUA domain-like': 2, 'Cystatin-like': 2, 'Rhodanese/Cell cycle control phosphatase': 2, 'Cryptochrome/photolyase FAD-binding domain': 2, 'Cryptochrome/photolyase, N-terminal domain': 2, 'Phospholipase D/nuclease': 2, 'DNA methylase specificity domain': 2, 'Tubulin nucleotide-binding domain-like': 2, 'Bacillus chorismate mutase-like': 2, 'Duffy binding domain-like': 2, 'ATC-like': 2, 'CoA-dependent acyltransferases': 2, 'FAD-binding/transporter-associated domain-like': 2, 'TIM beta/alpha-barrel': 2, 'CBS-domain pair': 2, 'DNA clamp': 2, 'Thiolase-like': 2, 'Interferon-induced guanylate-binding protein 1 (GBP1), C-terminal domain': 1, 'ATP-grasp': 1, 'Cyclophilin-like': 1, 'HPr-like': 1, 'Lesion bypass DNA polymerase (Y-family), little finger domain': 1, 'PEP carboxykinase-like': 1, 'PEP carboxykinase N-terminal domain': 1, 'Trypsin-like serine proteases': 1, 'Complement control module/SCR domain': 1, 'Subdomain of clathrin and coatomer appendage domain': 1, 'S-adenosyl-L-methionine-dependent methyltransferases': 1, 'Bromodomain-like': 1, 'Acyl-CoA dehydrogenase NM domain-like': 1, 'R1 subunit of ribonucleotide reductase, N-terminal domain': 1, 'PFL-like glycyl radical enzymes': 1, 'LDH C-terminal domain-like': 1, 'Single-stranded right-handed beta-helix': 1, 'Zincin-like': 1, 'Subtilisin-like': 1, 'TrkA C-terminal domain-like': 1, 'Phosphotyrosine protein phosphatases I-like': 1, 'FYVE/PHD zinc finger': 1, 'Protein kinase-like (PK-like)': 1, 'The "swivelling" beta/beta/alpha domain': 1, 'Aconitase iron-sulfur domain': 1, 'Anticodon-binding domain of a subclass of class I aminoacyl-tRNA synthetases': 1, 'Adenine nucleotide alpha hydrolase-like': 1, 'post-AAA+ oligomerization domain-like': 1, 'Hyaluronidase domain-like': 1, 'Gelsolin-like': 1, 'beta-hairpin stack': 1, 'Hyaluronate lyase-like, C-terminal domain': 1, 'Four-helical up-and-down bundle': 1, 'Flavodoxin-like': 1, 'Domain of poly(ADP-ribose) polymerase': 1, 'N-terminal domain of bifunctional PutA protein': 1, 'SAM domain-like': 1, 'PIN domain-like': 1, 'ATPase domain of HSP90 chaperone/DNA topoisomerase II/histidine kinase': 1, 'Penicillin-binding protein associated domain': 1, 'beta-lactamase/transpeptidase-like': 1, 'U5 small nuclear riboprotein particle assembly factor Aar2 N-terminal domain-like': 1, 'Anthrax protective antigen N-terminal-like': 1, 'Anthrax protective antigen C-terminal-like': 1, 'Menin N-terminal domain-like': 1, '6-phosphogluconate dehydrogenase C-terminal domain-like': 1, 'Aminoacid dehydrogenase-like, N-terminal domain': 1}
non_obl_freq_sorted={'TIM beta/alpha-barrel': 20, 'P-loop containing nucleoside triphosphate hydrolases': 15, 'Immunoglobulin-like beta-sandwich': 13, 'OB-fold': 10, 'Glycosyl hydrolase domain': 10, 'DNA/RNA-binding 3-helical bundle': 9, 'Reductase/isomerase/elongation factor common domain': 9, 'beta-Grasp (ubiquitin-like)': 9, 'Ferredoxin reductase-like, C-terminal NADP-linked domain': 6, 'SH3-like barrel': 5, 'Concanavalin A-like lectins/glucanases': 5, 'Rhodanese/Cell cycle control phosphatase': 4, 'Knottins (small inhibitors, toxins, lectins)': 4, 'Flavodoxin-like': 4, 'CH domain-like': 4, 'Galactose-binding domain-like': 4, 'Double psi beta-barrel': 4, 'Profilin-like': 4, 'GST C-terminal domain-like': 3, 'Thioredoxin fold': 3, 'Enolase N-terminal domain-like': 3, '6-phosphogluconate dehydrogenase C-terminal domain-like': 3, 'NAD(P)-binding Rossmann-fold domains': 3, 'PDZ domain-like': 3, 'beta-clip': 3, 'Periplasmic binding protein-like II': 3, 'ATP-grasp': 2, 'SAM domain-like': 2, 'BPTI-like': 2, 'Lipase/lipooxygenase domain (PLAT/LH2 domain)': 2, 'alpha/alpha toroid': 2, 'Double-stranded beta-helix': 2, 'beta-hairpin-alpha-hairpin repeat': 2, 'Trypsin-like serine proteases': 2, 'N-terminal domains of the minor coat protein g3p': 2, 'Four-helical up-and-down bundle': 2, 'FAD-binding/transporter-associated domain-like': 2, 'Uridine diphospho-N-Acetylenolpyruvylglucosamine reductase, MurB, C-terminal domain': 2, 'Cupredoxin-like': 2, 'FAS1 domain': 2, 'alpha-alpha superhelix': 2, 'Nucleoplasmin-like/VP (viral coat and capsid proteins)': 2, 'RuvA C-terminal domain-like': 2, 'SpoIIaa-like': 2, 'PUA domain-like': 2, 'RRF/tRNA synthetase additional domain-like': 2, 'Ribbon-helix-helix': 2, 'S-adenosyl-L-methionine-dependent methyltransferases': 2, 'Elongation factor/aminomethyltransferase common domain': 2, 'Folate-binding domain': 2, 'Cdc48 domain 2-like': 2, 'Subtilisin-like': 2, 'WWE domain': 2, 'MFPT repeat-like': 2, 'FnI-like domain': 2, 'EF Hand-like': 2, 'Ferredoxin-like': 2, 'Eukaryotic type KH-domain (KH-domain type I)': 2, 'Ribonuclease H-like motif': 2, 'Diaminopimelate epimerase-like': 2, 'Cysteine proteinases': 2, 'Cyclin-like': 2, 'Polo-box domain': 2, 'T-fold': 2, 'beta-Trefoil': 2, 'Ribosomal protein S5 domain 2-like': 2, 'ClpP/crotonase': 2, 'TNF receptor-like': 2, 'gamma-Crystallin-like': 2, 'Bromodomain-like': 2, 'DNA breaking-rejoining enzymes': 1, 'Iron-dependent repressor protein, dimerization domain': 1, 'Phospholipase C/P1 nuclease': 1, 'Caspase-like': 1, 'ArfGap/RecO-like zinc finger': 1, 'Complement control module/SCR domain': 1, 'Guanido kinase N-terminal domain': 1, 'Glutamine synthetase/guanido kinase': 1, 'C-type lectin-like': 1, '(Phosphotyrosine protein) phosphatases II': 1, 'GFP-like': 1, 'PreATP-grasp domain': 1, 'alpha/beta knot': 1, 'Bacillus chorismate mutase-like': 1, 'Cytochrome c': 1, '8-bladed beta-propeller': 1, 'PGBD-like': 1, 'Hedgehog/DD-peptidase': 1, 'Lipoxigenase': 1, 'Hypothetical protein YjiA, C-terminal domain': 1, 'Adenine nucleotide alpha hydrolase-like': 1, 'Ferritin-like': 1, 'Rubredoxin-like': 1, 'immunoglobulin/albumin-binding domain-like': 1, '7-stranded beta/alpha barrel': 1, 'Long alpha-hairpin': 1, 'Fe,Mn superoxide dismutase (SOD), C-terminal domain': 1, 'Prealbumin-like': 1, 'Alpha-lytic protease prodomain-like': 1, 'PR-1-like': 1, 'Crisp domain-like': 1, '5-bladed beta-propeller': 1, 'C2 domain-like': 1, 'GntR ligand-binding domain-like': 1, 'Formate dehydrogenase/DMSO reductase, domains 1-3': 1, 'DCoH-like': 1, 'Sec63 N-terminal domain-like': 1, 'PRC-barrel domain': 1, '6-bladed beta-propeller': 1, "5'-nucleotidase (syn. UDP-sugar hydrolase), C-terminal domain": 1, 'Metallo-dependent phosphatases': 1, 'Class II aaRS and biotin synthetases': 1, 'SufE/NifU': 1, 'CCCH zinc finger': 1, 'Zincin-like': 1, 'dsRBD-like': 1, 'Penicillin binding protein dimerisation domain': 1, 'beta-lactamase/transpeptidase-like': 1, 'Another 3-helical bundle': 1, 'PP2C-like': 1, 'GUN4-like': 1, '7-bladed beta-propeller': 1, 'alpha/beta-Hydrolases': 1, 'PEP carboxykinase-like': 1, 'PEP carboxykinase N-terminal domain': 1, 'WW domain-like': 1, 'FKBP-like': 1}
#~~~~~~~~~~~~~~~~~~~writing fold sccs ids of unique fold names obtained above

uniq_obl_folds=[]# sccs ids till fold of unique folds in homodomains
uniq_non_obl_folds=[]

for i in Hobl_freq_sorted.keys():
    for j in range(len(des_file)):
        if i==des_file.iloc[j,4]:
            uniq_obl_folds.append(des_file.iloc[j,2])
            break

for i in Hnon_obl_freq_sorted.keys():
    for j in range(len(des_file)):
        if i==des_file.iloc[j,4]:
            uniq_non_obl_folds.append(des_file.iloc[j,2])
            break


#entering result manually as it takes long to run
#uniq_obl_folds=['b.1', 'b.69', 'a.4', 'd.166', 'c.55', 'c.45', 'a.7', 'b.82', 'a.40', 'd.32', 'd.83', 'd.108', 'c.46', 'd.136', 'd.287', 'a.264', 'c.78', 'c.43', 'd.37', 'd.131', 'c.95', 'b.29']
#uniq_non_obl_folds=['c.37', 'b.1', 'c.46', 'a.40', 'g.8', 'b.82', 'g.3', 'b.37', 'b.6', 'b.118', 'b.121', 'a.43', 'd.289', 'b.169', 'b.85', 'g.27', 'a.39', 'd.51', 'c.55', 'b.34', 'd.21', 'a.74', 'd.223', 'd.96', 'b.40', 'a.4', 'b.42', 'd.14', 'c.14', 'g.24', 'b.36', 'b.29', 'b.11', 'c.94', 'c.1', 'a.29']


"""
with open('obl_homodomain_folds','w') as filehandle:
    filehandle.writelines('%s\t%s\t%s\n' %(sccs,key,value) for (key, value, sccs) in zip(Hobl_freq_sorted.keys(),Hobl_freq_sorted.values(),uniq_obl_folds))
with open('non_obl_homodomain_folds','w') as filehandle:
    filehandle.writelines('%s\t%s\t%s\n' %(sccs,key,value) for (key, value,sccs) in zip(Hnon_obl_freq_sorted.keys(),Hnon_obl_freq_sorted.values(),uniq_non_obl_folds))
"""
